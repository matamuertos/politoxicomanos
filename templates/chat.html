<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script>
    const socket = io({
        transports: ['websocket'],
        upgrade: false,
        secure: true
    });

    const chat = document.getElementById('chat');
    const input = document.getElementById('msg');
    const button = document.getElementById('send');

    button.onclick = () => {
        const message = input.value.trim();
        if (message) {
            socket.emit('chat_message', message);
            input.value = '';
        }
    };

    input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            e.preventDefault();
            button.click();
        }
    });

    socket.on('chat_message', (data) => {
        const line = document.createElement('div');
        line.innerHTML = `<span style="color:#888;">[${data.time}]</span> <strong>${data.username}:</strong> ${data.message}`;
        chat.appendChild(line);
        chat.scrollTop = chat.scrollHeight;
    });
</script>
